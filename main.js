const albums = {
  album1: {
    title: "Natural,Healthy",
    cover: "/Images/Natural Healthy Album Art.jpg",
    archiveId: "721808",
    download_link:"https://archive.org/download/queasy-natural-healthy/Queasy%20-%20Natural-%20Healthy.zip",
    description: `The follow up to the group's debut 2022 "Shining Now" LP, "Natural, Healthy" see's the band solidify their lineup as a 3 piece after shuffling through multiple members throughout most of 2023. The EP showcases Queasy as a band of songwriters, each member taking the reigns as "Frontperson" almost equally over the tidy 6 song run. With elements of indie rock, 90's inspired alternative, shoegaze and even some breakbeat experimentation, the group has honed the sound displayed in their earlier work into an offering that is at once catchy, raw, heavy, and at times surprising.
    
    Credits:
    Released May 24, 2024 (Digital Only)
    Songs written & arranged by Queasy
    Mike 'maddog' Davis: Drums, Guitar, Vocals
    Corinne Dodenhoff: Bass, Synth, Vocals
    Stevie Dodge: Guitar, Vocals
    Engineered, Mixed, & Mastered by Stevie Dodge at Jamtown Recording Studio, Philadelphia PA`,
    tracks: [
      { title: "Wayside", file: "queasy-natural-healthy/01%20Wayside.flac", lyrics: `walking along by the wayside \nnext to you i feel waist high \nit's a second life,it's a second try \nyou cast me out by the wayside \n\nso i guess, i'll stare at the floor \ncause you won't look at me anymore \n\ncan i share some ideas of mine? \ndo you have the time? \n"emergency,come over stat" \n"damn, your hair looks great like that" \nyou cast me out \n\nand there in the kitchen you said \nyou haven't had a friend like me in a while \nso i'd do anything to make you smile \nlike emulating your first move \nanticipating your next move \nhaven't seen nor heard, not another word \nyoucast me out by the wayside \n\nso i guess,i'll stare at the floor \nhaven't seen nor heard, not another word \nhaven't seen nor heard,not a fucking word ` },
      { title: "Never Thought", file: "queasy-natural-healthy/02%20Never%20Thought.flac", lyrics: `cleaning out your room \nfound a snoopy figurine \non a bookshelf full of hoarded recipies \nwe are closer now than we will ever be \ni know more now than you ever told me \n\nyou and i, we never talked too much \nwhy's it so hard to keep in touch? \ni can't say what i want \nwe never though about this \n\ncleaning out your closet \nfound your hat hanging up \ni wear it everyday now \nshields me from the sun \n"son, i never was good at keeping up one side of..." \n\nyou and i, we always thought too much \nwhy's it so hard to express them? \n now, you can't say what you want \nand we never talked about it` },
      { title: "Call Out What you See", file: "queasy-natural-healthy/03%20Call Out What You See.flac", lyrics: `letter to your neighbor \nneighbor's name is mine \nsimple as a gesture \ntorn from out of time \nlet me know and we'll go \nfarther then before \nhave you ever felt it? \nafter all this time? \n\nafter all this time \n\nwill you find me peeling the layers back again? \nthe difference between here and there is in my head \nhome is where you find it \nin season and in time \ngone without a reason \nneighbor's name is mine \n\nneighbor's name is mine \n\npulling back the drapes \nblowing off the dust \nspilling out the ? \n ?????? \nstumble up the steep stairs to something mine \nopen up my eyes \n\n i open up my eyes \ncall out what you see ` },
      { title: "Daybreak (Lomune)", file: "queasy-natural-healthy/04%20Daybreak%20%28Lomune%29.flac", lyrics: "lay down by a low moon \npast life vapors away \nto calm the mood \ncrushing doom \nwaits for you \n\npattern pushing back \nan invisible lack \nof follow through \n\nsomething not new \nsomething not perfumed \nnew ways of losing and uglying \nall we lost will come back to us \nand someday i will be reborn \n\nlay down by a low moon \npast life vapors away \nto calm the mood \ncrushing doom \nwaits for you \n\ndaybreak pushing back \nan invisible lack \nof follow through \n\nthese two dreams are madness and death \nthe mind wished and dreamed itself \n\n(olden incarnations in the wood \n i, the immaterial meadow of this world \nis nature proud?)" },
      { title: "Bad High", file: "queasy-natural-healthy/05%20Bad%20High.flac", lyrics: `here i go \ntripped and fell \nsilly me \nstumbling through life \nso clumsily \nhere i go \ngot too stoned yet again \nbut your voice in my head \na nice refrain \n\ni wanted more \nat times it was apealling \nbut i'm gone again \nto fight the empty feeling \nyou got me by \nthrough a bad high \n\nsit at home all alone, each passing day \nwhiling the hours away \nanother smoke, an inside joke \nthe only words i say \nanxiety, the price to pay \n\ni wanted more \nat times it was apealling \nbut i'm gone again \nto fight the empty feeling \nyou got me by \nthrough a bad high ` },
    ]
  },
  album2: {
    title: "Fake Fruit",
    cover: "/Images/Fake fruit Album Art.jpg",
    archiveId: "721606",
    download_link:"https://archive.org/compress/queasy-fake-fruit-covers/formats=WAVE&file=/queasy-fake-fruit-covers.zip",
    description: "Album One description goes here. Credits etc.",
    tracks: [
      { title: "Unreal Is Here [Chavez]", file: "queasy-fake-fruit-covers/Queasy%20-%20Fake%20Fruit%20%28Covers%29%20-%2001%20Unreal%20Is%20Here%20-Chavez-.flac", lyrics: "Lyrics for Wayside..." },
      { title: "Pleaser [Lemuria]", file: "queasy-fake-fruit-covers/Queasy%20-%20Fake%20Fruit%20%28Covers%29%20-%2002%20Pleaser%20-Lemuria-.flac", lyrics: "Lyrics for Never Thought..." },
      { title: "Forgive [Porches]", file: "queasy-fake-fruit-covers/Queasy%20-%20Fake%20Fruit%20%28Covers%29%20-%2003%20Forgive%20-Porches-.flac", lyrics: "Lyrics..." },
    ]
  },
  album3: {
    title: "Shining Now",
    cover: "/Images/Shining Now Album Art.jpg",
    archiveId: "710106",
    download_link:"https://archive.org/compress/queasy-shining-now/formats=WAVE&file=/queasy-shining-now.zip",
    description: "Album One description goes here. Credits etc.",
    tracks: [
      { title: "Feeling Funny", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2001%20Feeling%20Funny.flac", lyrics: "" },
      { title: "Big Dipper", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2002%20Big%20Dipper.flac", lyrics: `the earth is slow \nit's turning around \nand all that we can see \non the ground \nthe same old sky \nnight after night \na twinkle gone from the beholders eye \nlooking forward or looking far behind? \n\ndo you remember \nthe little dipper? \na dimmer streetlight \nat my bedside \n\nwell i remember \nyou said to me \nsometimes you will see \nanything that you want to see \n\nwell birth is slow \nit's taking it's time \nyou'll see what i'm seeing \nbut years behind \n\nand all i want \nis for you to say \ni'm happy you're happier today \nthan you were yesterday \n\nwill you ever know? \ni'm ready now to shine so bright \nwill you ever see? \nwhat i already see? \nwell i remember \nthe little dipper \nfading out behind the clouds and falling out of sight` },
      { title: "Fun X3", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2003%20Fun%20x3.flac", lyrics: `always on the ground, \nyou run, run, run \ntalking to yourself \nit's fun, fun, fun \ncan't explain the way you lied \ncan't escape the way he cried \ncan't escape \n\ni think you should stay a while \ni think you should try to smile \n\nwe've made it to the fall \nyou're blocking all my calls \nwe're crawling up the walls \nyou're blocking all my calls \n\nalways on the ground, \nyou run, run , run \ntalking to yourself \nit's fun, fun, fun \ncan't explain the way you lied \ncan't escape the way he cried \ncan't escape \n\ni think you should stay a while \ni think you should try to smile` },
      { title: "Spherical", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2004%20Spherical.flac", lyrics: `even now, i hear that awful sound \nin the silence it's awful loud \ndoes it feel wrong? \nto try to start it now? \nis it so hard to say "i'm sorry" now? \n\ni can feel it coursing through my blood \ndisjointed, we kneel to the same god \ni watched it grow \nit's spherical \nor so i tell myself` },
      { title: "Nice", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2005%20Nice.flac", lyrics: `everyday feels like faking \nwalking around with a grin \nif you're asking how i'm doing \nwell just look at the state that we're in \n\ni can't tell what's going on \ni can't tell what's gone wrong \n\nlook for the right words to say \nstring them up in a line \nthe whole world's fucking burning \nbut if you ask me how i've been i'll say just fine \n\ni can't tell what's going on \ni can't tell whats gone wrong \n\nnice to see you again, \nto see you my friend, it's nice \nso goddamn nice` },
      { title: "Tenderfoot", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2006%20Tenderfoot.flac", lyrics: `she can't think straight \nfloating away \nbeing held down \nby familiar sounds \nfix this feeling \ncracks in the ceiling \nfix this \n\ni can't see who's haunting me \ncan't compute memory \ni can't see who's haunting me \nyou're a ghost in my machine \n\nshe's drunk \ni'm stoned \nwe sleep alone \nstop this praying \nhow long are you staying? \nempty city \ncall her pretty \nface is a screen \na scream \n\ntake me` },
      { title: "Stained Glass", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2007%20Stained%20Glass.flac", lyrics: `and after after \nand after all \ni hear us crying \nyou hear the call \n\nand ever after \nthrough the wall \nthe sun it rises \nthe water falls \n\ngo on \n\nand after after \nand after all \ntiming is never \nall that you want \n\nand when you go there \nleave me behind \ni'll let you know then \nyou're on my mind \n\nfor all time \nyou,you're laughing now \nyou, like you're around \naround \naround \nforever \n\nand after after \nand after all \nthe sun is setting \nonce and for all \n\nand when you go there \nleave me behind \none day i know that \nill see you there \n\ngo on` },
      { title: "Brainzap", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2008%20Brainzap.flac", lyrics: `wake up, my head's buzzing way too loud \ncan't ask for help cause i'm way too proud \ni think i need someone to tell me what to do \n\nall of my friends think i'm acting crazy \nmemory's shot, and my mind is hazy \ncan't trust that anything i remember is true \n\nall of my nerves feel so fried \nwhatever, i know that i tried \ni'm tired of hearing the only way out is through \n\nwanna come down \nwanna calm down \nwanna come down \nbut i'm way too high off of the ground \n\nwhat's it like having a normal brain? \nwhen every decision don't cause you pain? \ncan i borrow your's for a while? \ncause i need a break \n\nthe doctor is giving me pills \nbut i feel the buzz inside still \nwhoever wired me up made a careless mistake \n\nwanna come down \nwanna calm down \nwanna come down \nbut i'm way too high off of the ground \n\nway too high off of the ground` },
      { title: "Cloudbusting", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2009%20Cloudbusting.flac", lyrics: `i'm just an empty shell \nall the guts and goop are spilling out \ni could spend my whole damn life just staring at the sky \nbusting all the clouds to keep the shine \n\nso i'll bury it and forget` },
      { title: "June", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2010%20June.flac", lyrics: `she worked in a department store \nkept her baby in an open drawer \nit all kind of just happened \nbut June, she came laughing \n\nshe got stuck inside her head \nnow she sleeps inside her mind \nshe got stuck inside her bed \nbut she tells me everything is fine \n\nhe wasn't what he said he'd be \nshe needed some new therapy \nand when she almost burned down the kitchen \ni wonder what she was wishing \n\nshe got stuck inside her head \nnow she sleeps inside her mind \nshe got stuck inside her bed \nbut she tells me everything is fine \n\nuntil it isn't` },
      { title: "Funny Feeling", file: "queasy-shining-now/Queasy%20-%20Shining%20Now%20-%2011%20Funny%20Feeling.flac", lyrics: `line connected to another line \none foot in front of the other \njust to get by \ntime's a luxury \none i didn't earn \npatience is a virtue \nsomething i never learned \n\nwaking up \nin a gray light mourning \nalarm bell sounding a silent warning \nthat funny feeling \n\ndesigns repeating \nan echo in space \naverting your eyes \nwhile it stares you in the face \nsoft rage, blank page \na hidden turn of phrase \nwritten in invisible ink you can't erase \n\nwaking up \nin a gray light mourning \nalarm bell sounding a silent warning \nthat funny feeling` },
    ]
  },
  album4: {
    title: "Self-Titled EP",
    cover: "/Images/Self Titled Album Art.jpg",
    archiveId: "721808",
    description: "Album One description goes here. Credits etc.",
    tracks: [
      { title: "Seven Futures", file: "queasy-natural-healthy/01%20Wayside.flac", lyrics: `when i go to the grocery store after 6am \ni disociate in the cereal isle \nredundant abundance doesn't function as a comfort \nwhen the meaningless choices pile up \n\nand i feel a way \nfeel it peel away \nthen i feel nothing \noh no \n\ni dreamt of a day \nwhen we had seven futures, all much the same \nnot great, but ok \nwe watched as the water slowly ate away \nthe blue room jellies \nwhat more can i say? \n\nand i feel a way \nfeel it peel away \nthen i feel nothing \noh no` },
      { title: "Hardball", file: "queasy-natural-healthy/02%20Never%20Thought.flac", lyrics: `big yellow taxi \nbig orange sun \nopen it's mouth \nand consume everyone \n\nwe had our chance and we blew it \ni took my shot and threw it \nwe had our chance and we blew it \ni took my shot \n\ndesert parking lot \nthe world is full of so much rot \ni can't control how bad i feel about it \n\ni give up, we fucked up \ni give up, we fucked up \ni give up \nfucked up again \n\nwe had our chance and we blew it \ni took my shot and threw it \nwe had our chance and we blew it \ni took my shot \n\nand you're sitting\nwatching everything you've ever wanted \neverything you've ever thought \nand every place you've ever haunted go` },
      { title: "Stranger", file: "queasy-natural-healthy/03%20Call Out What You See.flac", lyrics: "Lyrics..." },
      { title: "Room", file: "queasy-natural-healthy/04%20Daybreak%20%28Lomune%29.flac", lyrics: "Lyrics..." },
      { title: "Moth", file: "queasy-natural-healthy/05%20Bad%20High.flac", lyrics: "Lyrics..." },
      { title: "Head", file: "queasy-natural-healthy/05%20Bad%20High.flac", lyrics: "Lyrics..." },
    ]
  },
  // ... add album2, album3, album4 similarly with 'description' and 'lyrics' fields
};

// Cached audio object
let audio = new Audio();
let currentTrackIndex = null;
let currentAlbum = null;

const albumGrid = document.getElementById('albumGrid');
const playerView = document.getElementById('playerView');
const tracklist = document.getElementById('tracklist');
const albumArt = document.getElementById('albumArt');
const backButton = document.getElementById('backButton');
const downloadButton = document.getElementById('downloadButton');
const albumDescription = document.getElementById('albumDescription');

const singlePlayerContainer = document.createElement('div');
singlePlayerContainer.classList.add('single-player-container');

const trackTitleEl = document.createElement('div');
trackTitleEl.className = 'current-track-title';
trackTitleEl.textContent = ''; 

// Build custom audio player elements
const playBtn = document.createElement('button');
playBtn.className = 'play-btn';
playBtn.textContent = '▶';

const progressContainer = document.createElement('div');
progressContainer.className = 'progress-container';
const progressBar = document.createElement('div');
progressBar.className = 'progress-bar';
progressContainer.appendChild(progressBar);

const timeEl = document.createElement('span');
timeEl.className = 'time';
timeEl.textContent = '0:00';

// Wrap title + progress bar in a column
const progressWrapper = document.createElement('div');
progressWrapper.className = 'progress-wrapper';
progressWrapper.append(trackTitleEl, progressContainer);

// Final layout
singlePlayerContainer.append(playBtn, progressWrapper, timeEl);

// Insert custom player above tracklist
tracklist.parentNode.insertBefore(singlePlayerContainer, tracklist);

// Functions for audio
function formatTime(sec) {
  const m = Math.floor(sec / 60);
  const s = Math.floor(sec % 60);
  return `${m}:${s.toString().padStart(2, '0')}`;
}

function playTrack(index) {
  if (!currentAlbum) return;
  if (currentTrackIndex === index && !audio.paused) {
    audio.pause();
    playBtn.textContent = '▶';
    return;
  }

  const track = currentAlbum.tracks[index];
  audio.src = `https://dn${currentAlbum.archiveId}.ca.archive.org/0/items/${track.file}`;
  audio.play();
  currentTrackIndex = index;
  playBtn.textContent = '⏸';
  trackTitleEl.textContent = track.title;
}

// Event listeners
albumGrid.addEventListener('click', e => {
  const albumDiv = e.target.closest('.album');
  if (!albumDiv) return;

  const albumKey = albumDiv.dataset.album;
  const album = albums[albumKey];
  console.log(album);
  if (!album) return;

  currentAlbum = album;
  albumArt.src = album.cover;
  albumDescription.textContent = album.description || '';
  tracklist.innerHTML = '';
  console.log(currentAlbum);
  downloadButton.href = currentAlbum.download_link || '#';

  album.tracks.forEach((track, index) => {
    const trackDiv = document.createElement('div');
    trackDiv.className = 'track';

    const header = document.createElement('div');
    header.className = 'track-header';

    const titleEl = document.createElement('h3');
    titleEl.textContent = track.title;

    const lyricsBtn = document.createElement('button');
    lyricsBtn.className = 'lyrics-btn';
    lyricsBtn.textContent = 'Lyrics';

    const lyricsContent = document.createElement('div');
    lyricsContent.className = 'lyrics-content';
    lyricsContent.textContent = track.lyrics || 'No lyrics available';

    lyricsBtn.addEventListener('click', () => {
      lyricsContent.style.display = lyricsContent.style.display === 'block' ? 'none' : 'block';
    });

    header.append(titleEl, lyricsBtn);
    trackDiv.append(header, lyricsContent);
    tracklist.appendChild(trackDiv);

    titleEl.addEventListener('click', () => {
      playTrack(index);
    });
  });

  albumGrid.style.display = 'none';
  playerView.classList.add('active');
  stopAudio();
  currentTrackIndex = null;
  // Ensure album description is placed correctly on first open
  adjustDescriptionMobile();
});

// Custom player controls
playBtn.addEventListener('click', () => {
  if (!currentAlbum || currentTrackIndex === null) return;

  if (audio.paused) {
    audio.play();
    playBtn.textContent = '⏸';
  } else {
    audio.pause();
    playBtn.textContent = '▶';
  }
});

audio.addEventListener('timeupdate', () => {
  const percent = (audio.currentTime / audio.duration) * 100;
  progressBar.style.width = percent + '%';
  timeEl.textContent = formatTime(audio.currentTime);
});

progressContainer.addEventListener('click', e => {
  const rect = progressContainer.getBoundingClientRect();
  const percent = (e.clientX - rect.left) / rect.width;
  audio.currentTime = percent * audio.duration;
});

backButton.addEventListener('click', () => {
  stopAudio();
  playerView.classList.remove('active');
  albumGrid.style.display = 'grid';
  currentAlbum = null;
});


function stopAudio() {
  audio.pause();
  audio.currentTime = 0;
  playBtn.textContent = '▶';
  progressBar.style.width = '0%';
  timeEl.textContent = '0:00';
}

// Move description below tracklist on mobile
function adjustDescriptionMobile() {
  if (!currentAlbum) return;
  const playerView = document.getElementById('playerView');
  if (window.innerWidth <= 600) {
    // On mobile, place description at the very bottom of playerView (after player-top)
    playerView.appendChild(albumDescription);
    albumDescription.style.textAlign = 'center';
  } else {
    // On desktop, center description below both tracklist and album art
    playerView.appendChild(albumDescription);
    albumDescription.style.textAlign = 'center';
  }
}

window.addEventListener('resize', adjustDescriptionMobile);
window.addEventListener('load', adjustDescriptionMobile);
